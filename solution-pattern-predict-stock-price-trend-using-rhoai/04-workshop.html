<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Solution Pattern: Name Template :: Solution Patterns for Cloud Native Architectures</title>
    <link rel="canonical" href="https://redhat-solution-patterns.github.io/solution-patterns/solution-pattern-predict-stock-price-trend-using-rhoai/04-workshop.html">
    <link rel="prev" href="03-demo.html">
    <meta name="generator" content="Antora 3.0.0">
    <link rel="stylesheet" href="../_/css/site.css">
<link rel="icon" href="../_/img/favicon.ico" type="image/x-icon">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  </head>
  <body class="article">
<!-- Google tag (gtag.js) -->

<!--
  replace this with Google tag content
-->

<!-- Google tag (gtag.js) -->
<header class="header">

  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" style="font-size: 20px; color: white"
        href="https://redhat-solution-patterns.github.io/solution-patterns">
        <img src="../_/img/logo.png" height="35px" alt="Solution Patterns">&nbsp; Solution Patterns for Cloud Native Architectures</a>
      <button class="navbar-burger" data-target="topbar-nav">
      </button>
    </div>

    <div class="navbar-item"><span class="navbar-text"
        style="color: white; margin-left: 1rem; margin-right: 1rem;">|</span></div>

    <div class="navbar-item has-dropdown is-hoverable">
      <a class="navbar-link" href="#" style="color: white">Architectures &amp; Patterns</a>
      <div class="navbar-dropdown">
        <a class="navbar-item" href="https://www.redhat.com/architect/portfolio/" target="_blank">Portfolio Architecture&nbsp; </a>
        <a class="navbar-item" href="https://redhat-solution-patterns.github.io/solution-patterns/patterns.html" target="_blank">Solution Patterns </a>
        <a class="navbar-item" href="https://validatedpatterns.io/" target="_blank">Validated Patterns&nbsp;</a>
        <a class="navbar-item" href="https://catalog.redhat.com/solutions" target="_blank">Ecosystem Solutions&nbsp;</a>
      </div>
    </div>

    <div class="navbar-item has-dropdown is-hoverable">
      <a class="navbar-link" href="#" style="color: white">Resources</a>
      <div class="navbar-dropdown">
        <a class="navbar-item" target="_blank" href="https://developers.redhat.com">Red Hat Developers</a>
        <a class="navbar-item" target="_blank" href="https://developers.redhat.com/app-dev-platform">App Dev Platform</a>
        <a class="navbar-item" target="_blank" href="https://www.redhat.com/en/products/application-foundations">Red Hat Application Services</a>
      </div>
    </div>



    <a class="navbar-item" style="color: white" target="_blank" href="https://github.com/redhat-solution-patterns/redhat-solution-patterns.github.io/issues">Feedback</a>

    <a class="navbar-item" style="color: white" target="_blank" href="https://redhat-solution-patterns.github.io/solution-patterns/contributors-guide.html">Contribute</a>

  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="solution-pattern-predict-stock-price-trend-using-rhoai" data-version="master">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="index.html" class=" query-params-link">Predict stock price trend using Red Hat OpenShift AI</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="index.html">1. Home page</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="index.html#use-cases">1.1 Use cases</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="index.html#_the_story_behind_this_solution_pattern">1.2 The story behind this solution pattern</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="index.html#_the_solution">1.3 The solution</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="02-architecture.html">2. Architecture</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="02-architecture.html#tech_stack">2.1. Technology stack</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="02-architecture.html#in_depth">2.2. An in-depth look at the solution&#8217;s architecture</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="03-demo.html">3. See the Solution in Action</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="03-demo.html#_demonstration">3.1. Demonstration</a>
  </li>
</ul>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="04-workshop.html">4. Workshop</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#_installing_the_workshop_environment">4.1. Installing the workshop environment</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#deliver_wksp">4.2. Delivering the workshop</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-text"><a href="https://redhat-solution-patterns.github.io/solution-patterns/patterns.html" target="_blank" rel="noopener">Explore Red Hat Solution Patterns</a></span>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Predict stock price trend using Red Hat OpenShift AI</span>
    <span class="version">master</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">Predict stock price trend using Red Hat OpenShift AI</span>
      <ul class="versions">
        <li class="version is-current">
          <a href="index.html">master</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="index.html">Predict stock price trend using Red Hat OpenShift AI</a></li>
    <li><a href="04-workshop.html">4. Workshop</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/redhat-solution-patterns/solution-pattern-predict-stock-price-trend-using-rhoai/edit/main/documentation/modules/ROOT/pages/04-workshop.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<article class="doc">
<h1 class="page">Solution Pattern: Name Template</h1>
<h1 id="_workshop" class="sect0"><a class="anchor" href="#_workshop"></a><a class="link" href="#_workshop">Workshop</a></h1>
<div class="sect1">
<h2 id="_installing_the_workshop_environment"><a class="anchor" href="#_installing_the_workshop_environment"></a><a class="link" href="#_installing_the_workshop_environment">1. Installing the workshop environment</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_installing_the_environment"><a class="anchor" href="#_installing_the_environment"></a><a class="link" href="#_installing_the_environment">1.1. Installing the environment</a></h3>
<div class="paragraph">
<p>Login to <a href="https://demo.redhat.com/catalog" class="bare">https://demo.redhat.com/catalog</a> and create an OpenShift cluster with RHOAI and enable Open environment using either this <a href="https://demo.redhat.com/catalog?search=rhoai&amp;item=babylon-catalog-prod%2Fsandboxes-gpte.ocp4-workshop-rhods-base-aws.prod">one</a> or <a href="https://demo.redhat.com/catalog?search=rhods&amp;item=babylon-catalog-prod%2Fsandboxes-gpte.ocp4-wksp-base-rhods-on-rosa.prod">this</a> link.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_delivering_the_workshop"><a class="anchor" href="#_delivering_the_workshop"></a><a class="link" href="#_delivering_the_workshop">2. Delivering the workshop</a></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Login to the bastion host as well using the ssh terminal and configure your oc cli with credentials from OpenShift Cluster.</p>
<div class="imageblock">
<div class="content">
<img src="_images/wkshp_1.png" alt="wkshp 1" width="100%">
</div>
</div>
</li>
<li>
<p>Fork “main” branch from this <a href="https://github.com/solution-pattern-big-data/deployment">repo</a>.</p>
</li>
<li>
<p>Clone the above forked repo into bastion host and cd to this repo and cd to deployment-yaml.</p>
<div class="imageblock">
<div class="content">
<img src="_images/wkshp_2.png" alt="wkshp 2" width="100%">
</div>
</div>
</li>
<li>
<p>Run setup.sh file. This file will create the following things:</p>
<div class="ulist">
<ul>
<li>
<p>Project</p>
</li>
<li>
<p>Secrets required for Minio</p>
</li>
<li>
<p>Minio</p>
</li>
<li>
<p>Pipeline Server</p>
<div class="imageblock">
<div class="content">
<img src="_images/wkshp_3.png" alt="wkshp 3" width="100%">
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>This step will take 1 to 2 minutes. Go to project stock-predict in the RHOAI dashboard under “Data Science Projects”. Once you see “Import pipeline” in the “Pipelines” section in the stock-predict project, this step is complete.</p>
</li>
<li>
<p>Now create a workbench with the name “stock-predict-workbench” with following details under the “Workbenches” section. Use the “Standard Data Science” image from the “Image selection” drop down menu and select “Use existing data connection”. From this dropdown menu, select “Minio Connection”.</p>
<div class="imageblock">
<div class="content">
<img src="_images/wkshp_4.png" alt="wkshp 4" width="100%">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/wkshp_5.png" alt="wkshp 5" width="100%">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/wkshp_6.png" alt="wkshp 6" width="100%">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/wkshp_7.png" alt="wkshp 7" width="100%">
</div>
</div>
</li>
<li>
<p>Workbench creation may take 2 mins, once it is running state click on Open link.</p>
<div class="imageblock">
<div class="content">
<img src="_images/wkshp_8.png" alt="wkshp 8" width="100%">
</div>
</div>
</li>
<li>
<p>Click on “Allow selected permissions” as shown in the below screenshot. If it asks for login credentials, use the details.</p>
<div class="imageblock">
<div class="content">
<img src="_images/wkshp_9.png" alt="wkshp 9" width="100%">
</div>
</div>
</li>
<li>
<p>You will see this page after opening the workbench.</p>
<div class="imageblock">
<div class="content">
<img src="_images/wkshp_10.png" alt="wkshp 10" width="100%">
</div>
</div>
</li>
<li>
<p>Fork this <a href="https://github.com/solution-pattern-big-data/stockcheck-code">repo</a> under your github user.</p>
</li>
<li>
<p>Now clone the above forked git repo into this workbench using the steps mentioned in the screenshot and cd to notebooks folder.</p>
<div class="imageblock">
<div class="content">
<img src="_images/wkshp_11.png" alt="wkshp 11" width="100%">
</div>
</div>
</li>
<li>
<p>Now let us create a pipeline. In our pipeline, we have one stage only. There can be multiple stages in the pipeline. From the Launcher, click on the “Pipeline Editor” under Elyra.</p>
<div class="imageblock">
<div class="content">
<img src="_images/wkshp_12.png" alt="wkshp 12" width="100%">
</div>
</div>
</li>
<li>
<p>From stockcheck-code/notebooks, drag and drop the notebook “create_model.ipynb” onto the pipeline editor you just created.</p>
<div class="imageblock">
<div class="content">
<img src="_images/wkshp_13.png" alt="wkshp 13" width="100%">
</div>
</div>
</li>
<li>
<p>Right click on the box, and click on “Open Properties”.</p>
<div class="imageblock">
<div class="content">
<img src="_images/wkshp_14.png" alt="wkshp 14" width="100%">
</div>
</div>
</li>
<li>
<p>Under “NODE PROPERTIES”, select Runtime Image value: Python 3.9 (UBI9).</p>
<div class="imageblock">
<div class="content">
<img src="_images/wkshp_15.png" alt="wkshp 15" width="100%">
</div>
</div>
</li>
<li>
<p>Click on “Browse” under File Dependencies and select “requirements.txt” as shown in the below screenshot. This file contains the python packages name, which will be installed.</p>
<div class="imageblock">
<div class="content">
<img src="_images/wkshp_16.png" alt="wkshp 16" width="100%">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/wkshp_17.png" alt="wkshp 17" width="100%">
</div>
</div>
</li>
<li>
<p>Under Additional Properties, add an Environment variable named “TICKER”. You can use either of the values: IBM or AAPL or MSFT. Make sure to remember this value.</p>
<div class="imageblock">
<div class="content">
<img src="_images/wkshp_18.png" alt="wkshp 18" width="100%">
</div>
</div>
</li>
<li>
<p>Click on the “Save pipeline” button as shown below.</p>
<div class="imageblock">
<div class="content">
<img src="_images/wkshp_19.png" alt="wkshp 19" width="100%">
</div>
</div>
</li>
<li>
<p>Now run the pipeline by clicking on “Run Pipeline” button.</p>
<div class="imageblock">
<div class="content">
<img src="_images/wkshp_20.png" alt="wkshp 20" width="100%">
</div>
</div>
</li>
<li>
<p>If it prompts you to save the changes, click on Save. Next it will ask you for the Pipeline Name, enter: “run1” and click “OK”.</p>
<div class="imageblock">
<div class="content">
<img src="_images/wkshp_21.png" alt="wkshp 21" width="100%">
</div>
</div>
</li>
<li>
<p>Once the job is submitted successfully, you will see this message. Please take a note of this path in object storage.</p>
<div class="imageblock">
<div class="content">
<img src="_images/wkshp_22.png" alt="wkshp 22" width="100%">
</div>
</div>
</li>
<li>
<p>Now we will see the output/result from the above run in MINIO console. Let us get the MINIO console url using this cli command.</p>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell script hljs" data-lang="shell script">oc get route -n stock-predict | grep minio</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/wkshp_23.png" alt="wkshp 23" width="100%">
</div>
</div>
</li>
<li>
<p>Copy this url and open it from any browser and use the credentials from minio-root-user secret in the stock-predict project from OpenShift console.</p>
<div class="imageblock">
<div class="content">
<img src="_images/wkshp_24.png" alt="wkshp 24" width="100%">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/wkshp_25.png" alt="wkshp 25" width="100%">
</div>
</div>
</li>
<li>
<p>Now go to the specific folder mentioned in the Job run details under Object Browser as shown below. Click on the html page and download it. Open this file in the browser to see the run of the pipeline output. If you don&#8217;t see the file yet, wait for 2 to 3 mins for the pipeline to finish.</p>
<div class="imageblock">
<div class="content">
<img src="_images/wkshp_26.png" alt="wkshp 26" width="100%">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/wkshp_27.png" alt="wkshp 27" width="100%">
</div>
</div>
</li>
<li>
<p>This pipeline saves the model named forecast.onnx in the Models bucket.</p>
<div class="imageblock">
<div class="content">
<img src="_images/wkshp_28.png" alt="wkshp 28" width="100%">
</div>
</div>
</li>
<li>
<p>Now the model has been generated and saved in a MINIO s3 bucket as shown above. We will be deploying this model using this cli command from deployment-yaml folder on bastion host:</p>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell script hljs" data-lang="shell script">oc apply -k model-server</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/wkshp_29.png" alt="wkshp 29" width="100%">
</div>
</div>
</li>
<li>
<p>In a few minutes our model will be deployed in RHOAI and will be accessible via a url. Copy this url as we will be needing it.</p>
<div class="imageblock">
<div class="content">
<img src="_images/wkshp_30.png" alt="wkshp 30" width="100%">
</div>
</div>
</li>
<li>
<p>Now we will be deploying a flask application which will consume this URL and will make the Stock price trend forecast.</p>
</li>
<li>
<p>Fork this <a href="https://github.com/gmidha1/flask-app">repo</a> under your github user.</p>
</li>
<li>
<p>Now using the developer role in OpenShift console, deploy this application using Import from Git under stock-predict project.</p>
<div class="imageblock">
<div class="content">
<img src="_images/wkshp_31.png" alt="wkshp 31" width="100%">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/wkshp_32.png" alt="wkshp 32" width="100%">
</div>
</div>
</li>
<li>
<p>Use Dockerfile strategy and put . in the Dockerfile path.</p>
<div class="imageblock">
<div class="content">
<img src="_images/wkshp_33.png" alt="wkshp 33" width="100%">
</div>
</div>
</li>
<li>
<p>Use Target port as 5000</p>
<div class="imageblock">
<div class="content">
<img src="_images/wkshp_34.png" alt="wkshp 34" width="100%">
</div>
</div>
</li>
<li>
<p>Next click on Deployment as shown in the above screenshot and add an environment variable: MODEL_URL and its value will come from RHOAI model url. Once done, click on “Create”.</p>
<div class="imageblock">
<div class="content">
<img src="_images/wkshp_35.png" alt="wkshp 35" width="100%">
</div>
</div>
</li>
<li>
<p>Build will run and it will generate a container image and then deployment will create a pod using the image. This pod will be exposed through a route and service. This process will take 2 to 3 mins.</p>
</li>
<li>
<p>Now get the route for the flask app and access the url in a browser. Flask app UI will look like this:</p>
<div class="imageblock">
<div class="content">
<img src="_images/wkshp_36.png" alt="wkshp 36" width="100%">
</div>
</div>
</li>
<li>
<p>Since we entered TICKER environment value as AAPL(apple stock) in the pipeline we ran. From First drop down select AAPL. From the second drop down select 6 months or 1 year of past duration as per your choice. Now click on “Generate forecast”. This will show us the forecast of Stock price trend in the graph.</p>
<div class="imageblock">
<div class="content">
<img src="_images/wkshp_37.png" alt="wkshp 37" width="100%">
</div>
</div>
</li>
</ul>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="03-demo.html" class="query-params-link">3. See the Solution in Action</a></span>
</nav>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
</div>
<footer class="footer">
  <img
          src="../_/img/app-services-logo.png" height="40px" alt="Cloud Native Architecture Solution Patterns"  href="https://redhat.com" ></a>
</footer><script src="../_/js/vendor/clipboard.js"></script>
<script src="../_/js/site.js"></script>
<script async src="../_/js/vendor/highlight.js"></script>
  </body>
</html>
